{%extends 'base.html'%} {%block content%}
<div id="root" class="container">
    <h1>Result | XML2CSV</h1>
    {%with messages = get_flashed_messages()%} {%if messages%}
    <ul style="color:red">
        {%for msg in messages%}
        <li>{{msg}}</li>
        {%endfor%}
    </ul>
    {%endif%} {%endwith%}

    {%if dataframe%}
    {{SET_GLOBAL('lvl',0)}}
    {{SET_GLOBAL('min',0)}}
    {{SET_GLOBAL('open_ul',0)}}
    {{SET_GLOBAL('open_li',0)}}
    {{SET_GLOBAL('prev_tag','')}}
    <ul>
        {%for row in dataframe%}

            {% if row[1] > GET_GLOBAL('lvl') %} IF NESTING_LEVEL GT LVL CONDITION 
            <ul>
                <li>
                    <input type="checkbox" name="{{row[0]}}" value="{{row[0]}}">Nesting_Level={{row[1]}}.   <b>{{row[0]}}</b> --Lvl= {{GET_GLOBAL('lvl')}}     min= {{GET_GLOBAL('min')}}
            {{SET_GLOBAL('min',GET_GLOBAL('lvl'))}}
            {{SET_GLOBAL('lvl',row[1])}}
            {{SET_GLOBAL('open_li',GET_GLOBAL('open_li')+1)}}
            {{SET_GLOBAL('open_ul',GET_GLOBAL('open_ul')+1)}}
            {{SET_GLOBAL('prev_tag','IF')}}
            <br>
            open_li={{GET_GLOBAL('open_li')}}
            open_ul={{GET_GLOBAL('open_ul')}}
            <br>

            
            {%elif row[1]==GET_GLOBAL('lvl') %} ELIF NESTING_LEVEL == LVL CONDITION 
                {%if GET_GLOBAL('open_li')>0 and GET_GLOBAL('prev_tag')=='IF'%}
                    <br>
                    </li>
                {{SET_GLOBAL('open_li',GET_GLOBAL('open_li')-1)}}
                {{SET_GLOBAL('prev_tag','ELIF')}}
                {%endif%}
            open_li={{GET_GLOBAL('open_li')}}
            open_ul={{GET_GLOBAL('open_ul')}}
            <li>
                <input type="checkbox" name="{{row[0]}}" value="{{row[0]}}">Nesting_Level={{row[1]}}.   <b>{{row[0]}}</b> --Lvl= {{GET_GLOBAL('lvl')}}     min= {{GET_GLOBAL('min')}}
            </li>
            <br>

            {%else%} ELSE CONDITION NESTING_LEVEL LT LVL CONDITION
            {%for _ in range(GET_GLOBAL('lvl')-row[1])%}
                {%if GET_GLOBAL('open_ul')>0%}
                    <br>
                    </ul>
                    {{SET_GLOBAL('open_ul',GET_GLOBAL('open_ul')-1)}}
                {%endif%}
                {%if GET_GLOBAL('open_li')>0%}
                    <br>
                    </li>
                    {{SET_GLOBAL('open_li',GET_GLOBAL('open_li')-1)}}
                {%endif%}
            {%endfor%}
            open_li={{GET_GLOBAL('open_li')}}
            open_ul={{GET_GLOBAL('open_ul')}}
            <li>
                <input type="checkbox" name="{{row[0]}}" value="{{row[0]}}">Nesting_Level={{row[1]}}.   <b>{{row[0]}}</b> --Lvl= {{GET_GLOBAL('lvl')}}     min= {{GET_GLOBAL('min')}}
            <br>
            {{SET_GLOBAL('lvl',row[1])}}
            {{SET_GLOBAL('open_li',GET_GLOBAL('open_li')+1)}}
            {%endif%} 
        {%endfor%}
        
        {%if GET_GLOBAL('open_li')>0%}
        You are here: {{GET_GLOBAL('open_li')}}
            {%for x in range(GET_GLOBAL('open_li')-1)%}
            </li>
            {%endfor%}
            {{SET_GLOBAL('open_li',0)}}
        {%endif%}

        {%if GET_GLOBAL('open_ul')>0%}
        Then again you are here: {{GET_GLOBAL('open_ul')}}
            {%for x in range(GET_GLOBAL('open_ul')-1)%}
            </ul>
            {%endfor%}
            {{SET_GLOBAL('open_ul',0)}}
        {%endif%}
    </ul>
    {%endif%}
</div>
{%endblock%}